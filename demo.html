<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>n8n Hero + Modal Demo</title>

  <style>
    /* ====== 仅用于本示例的 Hero 简单样式（你真实站点已有 CSS，可忽略这一段） ====== */
    body{ margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "PingFang SC", "Microsoft YaHei"; }
    .gpt-hero{
      min-height: 60vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 40px 16px;
      background: #0b0f14;
    }
    .gpt-hero-link{
      position: relative;
      display:block;
      width: min(1100px, 100%);
      border-radius: 18px;
      overflow:hidden;
      text-decoration:none;
    }
    .gpt-hero-image{
      width:100%;
      height: min(520px, 60vh);
      object-fit: cover;
      display:block;
      filter: saturate(1.05);
      transform: translateZ(0);
    }
    .gpt-hero-overlay{
      position:absolute; inset:0;
      display:flex; flex-direction:column;
      justify-content:flex-end;
      padding: 26px 26px;
      background: linear-gradient(to top, rgba(0,0,0,.62), rgba(0,0,0,.12) 55%, rgba(0,0,0,0));
      color:#fff;
      gap: 8px;
    }
    .gpt-hero-title{ margin:0; font-size: 36px; letter-spacing:.2px; }
    .gpt-hero-subtitle{ margin:0; opacity:.88; }
    .gpt-hero-button{
      margin-top: 8px;
      display:inline-flex;
      width: fit-content;
      padding: 10px 14px;
      border-radius: 999px;
      background: rgba(255,255,255,.14);
      border: 1px solid rgba(255,255,255,.18);
      color:#fff;
      font-weight: 600;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }
  </style>

  <!-- =========================
       下面这段才是你要的：Modal CSS（独立，不依赖其它）
       ========================= -->
  <style>
  /* ===== [PATCH INSERT: n8n.modal.css] ===== */

  /* overlay */
  /* ===== [PATCH REPLACE: n8n.modal.visibility.lock] ===== */

  /* 强制默认永远不可见（防止被你现有 CSS 覆盖） */
  #n8n-modal{
    position: fixed;
    inset: 0;
    z-index: 9999;

    display: none !important;       /* 关键：默认硬隐藏 */
    visibility: hidden !important;  /* 双保险 */
    opacity: 0 !important;
    pointer-events: none !important;
  }

  /* 只有显式打开才可见（不用 class，避免冲突） */
  #n8n-modal[data-open="1"]{
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
    pointer-events: auto !important;
  }

  /* ===== [PATCH END] ===== */

  .n8n-modal-backdrop{
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,.58);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }

  /* dialog */
  .n8n-modal-dialog{
    position: relative;
    width: min(980px, calc(100vw - 40px));
    margin: 0 auto;
    top: 50%;
    transform: translateY(-50%);
    border-radius: 18px;
    overflow: hidden;
    box-shadow: 0 20px 60px rgba(0,0,0,.45);
    border: 1px solid rgba(255,255,255,.08);
  }

  /* close btn */
  .n8n-modal-close{
    position: absolute;
    top: 12px;
    right: 12px;
    width: 38px;
    height: 38px;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,.12);
    background: rgba(20,20,20,.55);
    color: rgba(255,255,255,.92);
    font-size: 22px;
    line-height: 36px;
    cursor: pointer;
    z-index: 2;
  }

  .n8n-modal-close:hover{
    background: rgba(20,20,20,.75);
  }

  /* layout: half + half */
  .n8n-modal-grid{
    display: grid;
    grid-template-columns: 1fr 1fr;
    min-height: 320px;
  }

  /* panels */
  .n8n-panel{
    padding: 36px 34px 34px;
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  /* 左右面板用你要求的 id：n8n-0 / n8n-1 */
  #n8n-0{
    background: #ffffff;
    color: #0b0f14;
  }

  #n8n-1{
    background: #f2f3f5;
    color: #0b0f14;
  }

  .n8n-title{
    margin: 0;
    font-size: 28px;
    letter-spacing: .2px;
    line-height: 1.15;
  }

  .n8n-desc{
    margin: 0;
    font-size: 14px;
    opacity: .78;
    line-height: 1.55;
  }

  /* learn more */
  .n8n-learn{
    margin-top: 10px;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    text-decoration: none;
    font-weight: 600;
    color: #1a73e8;
    width: fit-content;
  }

  .n8n-learn:hover{
    text-decoration: underline;
  }

  .n8n-arrow{
    font-size: 18px;
    transform: translateY(-1px);
  }

  /* mobile: stack */
  @media (max-width: 768px){
    .n8n-modal-dialog{
      width: min(560px, calc(100vw - 26px));
    }
    .n8n-modal-grid{
      grid-template-columns: 1fr;
    }
    .n8n-panel{
      padding: 28px 22px 24px;
    }
    .n8n-title{
      font-size: 22px;
    }
  }

  /* ===== [PATCH END] ===== */
  </style>
</head>

<body>

  <!-- Hero：你真实页面已有这块结构，这里用同款结构做验证 -->
  <section class="gpt-hero">
    <a href="https://oliverfr.com/workflow-app.html" class="gpt-hero-link" target="_blank" rel="noopener noreferrer">
      <!-- 你真实项目里是 n8n.png，这里如果没图会显示 broken，但不影响弹窗逻辑验证 -->
      <img src="n8n.png" alt="n8n" class="gpt-hero-image" />
      <div class="gpt-hero-overlay">
        <h1 class="gpt-hero-title">n8n</h1>
        <p class="gpt-hero-subtitle">n8n console&前端demo</p>
        <span class="gpt-hero-button">Learn More</span>
      </div>
    </a>
  </section>

  <!-- ===== [PATCH INSERT: n8n.modal.html] ===== -->
  <div id="n8n-modal" class="n8n-modal" aria-hidden="true" data-open="0">
    <div class="n8n-modal-backdrop" data-n8n-close></div>

    <div class="n8n-modal-dialog" role="dialog" aria-modal="true" aria-labelledby="n8n-modal-title">
      <button class="n8n-modal-close" type="button" aria-label="Close" data-n8n-close>×</button>

      <div class="n8n-modal-grid">
        <!-- Left -->
        <section id="n8n-0" class="n8n-panel n8n-panel-left">
          <h2 id="n8n-modal-title" class="n8n-title">n8n前端demo</h2>
          <p class="n8n-desc">执行工作流与postgres SQL交互</p>
          <a class="n8n-learn" href="https://oliverfr.com/workflow-app.html" target="_blank" rel="noopener noreferrer">
            Learn more
            <span class="n8n-arrow" aria-hidden="true">›</span>
          </a>
        </section>

        <!-- Right -->
        <section id="n8n-1" class="n8n-panel n8n-panel-right">
          <h2 class="n8n-title">n8n console</h2>
          <p class="n8n-desc">n8n.oliverfr.com子域自定义带Auth门禁</p>
          <a class="n8n-learn" href="http://n8n.oliverfr.com" target="_blank" rel="noopener noreferrer">
            Learn more
            <span class="n8n-arrow" aria-hidden="true">›</span>
          </a>
        </section>
      </div>
    </div>
  </div>
  <!-- ===== [PATCH END] ===== -->

  <!-- =========================
       Modal JS：独立封装，不影响其它脚本
       ========================= -->
  <script>
  /* ===== [PATCH INSERT: n8n.modal.js.dataset_open] ===== */
  (() => {
    const modal = document.getElementById("n8n-modal");
    const trigger = document.querySelector(".gpt-hero-link");
    if (!modal || !trigger) return;

    // 初始强制关闭（兜底：防止你其它脚本先打开）
    modal.dataset.open = "0";
    modal.setAttribute("aria-hidden", "true");

    const lockScroll = () => {
      document.documentElement.style.overflow = "hidden";
      document.body.style.overflow = "hidden";
    };

    const unlockScroll = () => {
      document.documentElement.style.overflow = "";
      document.body.style.overflow = "";
    };

    const open = () => {
      modal.dataset.open = "1";
      modal.setAttribute("aria-hidden", "false");
      lockScroll();
    };

    const close = () => {
      modal.dataset.open = "0";
      modal.setAttribute("aria-hidden", "true");
      unlockScroll();
    };

    // 点击 hero：普通点击打开弹窗；Ctrl/⌘/中键保持原链接行为（工程级保留）
    trigger.addEventListener("click", (e) => {
      if (e.ctrlKey || e.metaKey || e.button === 1) return;
      e.preventDefault();
      open();
    }, { passive: false });

    // 点击遮罩 / X 关闭
    modal.addEventListener("click", (e) => {
      const t = e.target;
      if (t && t.hasAttribute && t.hasAttribute("data-n8n-close")) close();
    });

    // ESC 关闭
    window.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && modal.dataset.open === "1") close();
    });
  })();
  /* ===== [PATCH END] ===== */
  </script>

</body>
</html>
