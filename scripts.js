/***************************************************
 * scripts.js
 ***************************************************/
!function(){function w(a,b){var c=0,d=a.length;function e(){++c>=d&&b()}a.forEach(function(a){a.complete?e():(a.addEventListener("load",e),a.addEventListener("error",e))}),0===d&&b()}const i=()=>{const a=document.getElementById("hero-slides"),b=document.querySelectorAll(".hero-dots .dot");if(!a||!b.length)return;let c=0,d=a.children.length;function e(){c=(c+1)%d,a.style.transform=`translateX(-${c*100}%)`,b.forEach((a,b)=>{a.classList.toggle("active",b===c)})}b.forEach((b,d)=>{b.addEventListener("click",()=>{c=d,a.style.transform=`translateX(-${c*100}%)`,b.forEach((a,e)=>{a.classList.toggle("active",e===c)})})}),setInterval(e,5e3)};const t=()=>{if("undefined"==typeof emailjs)return;emailjs.init("HXCThZROMytOt-wyp");const a=document.getElementById("contactForm");a&&a.addEventListener("submit",b=>{b.preventDefault(),emailjs.sendForm("service_1ffkva1","template_ypdj9n9",a).then(()=>{alert("邮件已发送成功，我们将尽快与您联系！"),a.reset()}).catch(b=>{console.error("邮件发送失败：",b),alert("邮件发送失败，请稍后再试。")})})},n=()=>{const a=document.querySelector(".compare-features .btn");a&&a.addEventListener("click",()=>{alert("对比功能暂未实现 (预留)！")})},o=()=>{const a=document.getElementById("menuIcon"),b=document.getElementById("mobileNav"),c=document.getElementById("closeBtn");if(!a||!b||!c)return;a.addEventListener("click",()=>{b.classList.add("active")}),c.addEventListener("click",()=>{b.classList.remove("active")}),b.querySelectorAll("ul li a").forEach(a=>{a.addEventListener("click",()=>{b.classList.remove("active")})})},r=()=>{document.querySelectorAll("[data-modal-target]").forEach(a=>{a.addEventListener("click",()=>{const b=document.querySelector(a.getAttribute("data-modal-target"));b&&b.classList.add("active")})}),document.querySelectorAll("[data-modal-close]").forEach(a=>{a.addEventListener("click",()=>{const b=a.closest(".modal");b&&b.classList.remove("active")})})},s=()=>{const a=document.getElementById("infiniteScroller"),b=document.querySelector(".pause-btn");if(!a||!b)return;const c=["A peaceful brookside setting.png","A scenic riverside bend.png","A serene coastal shore.png","A shaded forest path.png"];let d=!1,f=0,g=[],h;h=document.createElement("div"),h.className="infinite-scroller-track",h.style.display="flex",h.style.position="relative",h.style.transform="translateX(0)",a.appendChild(h);for(let e=0;e<2;e++)c.forEach(createItem);function createItem(a){const b=document.createElement("div");b.className="infinite-scroller-item",b.style.position="absolute",b.style.width="100%";const d=document.createElement("img");d.src=a,d.alt=a,d.style.width="100%",d.style.objectFit="cover",b.appendChild(d),h.appendChild(b);let e=g.length===0?0:g[g.length-1].x+b.offsetWidth;b.style.left=e+"px",g.push({el:b,x:e,width:b.offsetWidth})}function j(e){if(!d){const f=e-lastTime;lastTime=e;const j=spd*(f/16.67);g.forEach(a=>{a.x-=j,a.el.style.left=a.x+"px"});const k=g[g.length-1];k.x+k.width<window.innerWidth+100&&createItem(c[g.length%c.length])}requestAnimationFrame(j)}let lastTime=0,spd=0.3; b.classList.remove("paused"),b.addEventListener("click",()=>{d=!d,b.classList.toggle("paused")}),requestAnimationFrame(j)};const p=()=>{document.querySelectorAll(".product-card img").forEach(a=>{a.addEventListener("click",()=>{window.location.href=a.alt.toLowerCase().replace(/\s+/g,"-")+".html"})})},l=()=>{document.querySelectorAll(".flip-btn-front").forEach(a=>{a.addEventListener("click",()=>{a.closest(".card").style.transform="rotateY(180deg)"})}),document.querySelectorAll(".flip-btn-back").forEach(a=>{a.addEventListener("click",()=>{a.closest(".card").style.transform="rotateY(0deg)"})})},u=()=>{const a=document.getElementById("animationCanvas"),b=a&&a.getContext("2d");if(!a||!b)return;const c=["A young man standing in a natural landscape1.png","A young man standing in a natural landscape2.png","A young man standing in a natural landscape3.png"];let d=[],e=0,f=!0,g=0,h=0.02,i=1e3/24,j=0,k=0;const m=document.getElementById("playPauseButton");c.forEach((a,e)=>{let k=new Image;k.src=a,k.onload=function(){d[e]=k,++loaded===1&&requestAnimationFrame(v)},k.onerror=function(){console.error("❌ 图片加载失败: "+a)}});function v(a){if(!f||loaded===0)return;if(a-j>i){b.clearRect(0,0,a.width,a.height);let c=(e+1)%c.length;b.globalAlpha=1-g,draw(b,d[e]),b.globalAlpha=g,draw(b,d[(e+1)%c.length]),g+=h,g>=1&&(g=0,e=(e+1)%c.length),j=a}requestAnimationFrame(v)}function draw(a,b){const c=a.canvas.width/a.canvas.height,d=b.width/b.height;let e,f,g,h;d>c?(f=a.canvas.height*0.9,e=b.width*(f/b.height),g=(a.canvas.width-e)/2,h=(a.canvas.height-f)/2):(e=a.canvas.width,f=b.height*(e/b.width),g=0,h=(a.canvas.height-f)/2),a.drawImage(b,g,h,e,f)} m&&m.addEventListener("click",()=>{f=!f,m.textContent=f?"❚❚":"▶",f&&requestAnimationFrame(v)}),m&&(m.textContent="❚❚")} ,g=function(){const a=document.querySelector(".touch1-carousel-track"),b=Array.from(a?a.children:[]),c=document.querySelector(".touch1-prev-btn"),d=document.querySelector(".touch1-next-btn");if(!a||!b.length||!c||!d)return;let e=0,f=615+15;function g(){a.style.transform=`translateX(-${e*f}px)`,c.disabled=0===e,d.disabled=e===b.length-1} c.addEventListener("click",()=>{e>0&&(e--,g())}),d.addEventListener("click",()=>{e<b.length-1&&(e++,g())}),g()},h=function(){const a=document.getElementById("mobileNav"),b=document.getElementById("mobileNavLevel2Home"),c=document.getElementById("mobileNavLevel2Products"),d=document.getElementById("mobileNavLevel2About"),e=document.getElementById("mobileNavLevel2Contact");if(!a||!b||!c||!d||!e){console.log("多级菜单面板未找到，若不需要此功能可删除本脚本。");return} function f(a){a.classList.add("active"),[b,c,d,e].forEach(x=>{if(x!==a)x.classList.remove("active")}),a&&a.classList.add("active")} function g(){[b,c,d,e].forEach(x=>x.classList.remove("active")),a.classList.add("active")} a.querySelectorAll("ul li a").forEach(x=>{const n=x.getAttribute("data-level");n==="home"?x.addEventListener("click",e=>{e.preventDefault(),f(b)}):n==="products"?x.addEventListener("click",e=>{e.preventDefault(),f(c)}):n==="about"?x.addEventListener("click",e=>{e.preventDefault(),f(d)}):n==="contact"&&x.addEventListener("click",e=>{e.preventDefault(),f(e)})});document.querySelectorAll(".menu-panel__back").forEach(x=>{x.addEventListener("click",e=>{e.preventDefault(),g()})});document.querySelectorAll(".menu-panel__close").forEach(x=>{x.addEventListener("click",e=>{e.preventDefault(),a.classList.remove("active"),[b,c,d,e].forEach(y=>y.classList.remove("active"))})})},j=function(){document.querySelectorAll(".product-card img").forEach(a=>{a.addEventListener("click",()=>{window.location.href=a.alt.toLowerCase().replace(/\s+/g,"-")+".html"})})},k=function(){document.querySelectorAll(".flip-btn-front").forEach(a=>{a.addEventListener("click",()=>{a.closest(".card").style.transform="rotateY(180deg)"})});document.querySelectorAll(".flip-btn-back").forEach(a=>{a.addEventListener("click",()=>{a.closest(".card").style.transform="rotateY(0deg)"})})};document.addEventListener("DOMContentLoaded",()=>{i();t();n();o();r();s();j();k();u();g()}),window.addEventListener("load",()=>{const a=document.querySelectorAll(".spec1-carousel-slide img");a.length>0&&w(Array.from(a),()=>{initspec1ManualCarouselTrack()})})}();
