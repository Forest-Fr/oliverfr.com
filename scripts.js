/*************************************************** 
 * scripts.js 
 ***************************************************/
function waitImagesLoaded(a,b){let c=0,t=a.length;function d(){c++,c>=t&&b()}a.forEach(e=>{e.complete?d():(e.addEventListener("load",d),e.addEventListener("error",d))});t===0&&b()}const initHeroCarousel=()=>{const hs=document.getElementById("hero-slides"),ds=document.querySelectorAll(".hero-dots .dot");if(!hs||!ds.length)return;let i=0,t=hs.children.length;const u=()=>{i=(i+1)%t;hs.style.transform=`translateX(-${i*100}%)`,ds.forEach((e,n)=>{e.classList.toggle("active",n===i)})};ds.forEach((e,n)=>{e.addEventListener("click",()=>{i=n;hs.style.transform=`translateX(-${i*100}%)`,ds.forEach((r,s)=>{r.classList.toggle("active",s===i)})})}),setInterval(u,5000)};const initEmailJS=()=>{if(typeof emailjs==="undefined")return;emailjs.init("HXCThZROMytOt-wyp");const f=document.getElementById("contactForm");f&&f.addEventListener("submit",e=>{e.preventDefault(),emailjs.sendForm("service_1ffkva1","template_ypdj9n9",f).then(()=>{alert("邮件已发送成功，我们将尽快与您联系！"),f.reset()}).catch(r=>{console.error("邮件发送失败：",r),alert("邮件发送失败，请稍后再试。")})})};const initCompareFeature=()=>{const e=document.querySelector(".compare-features .btn");e&&e.addEventListener("click",()=>{alert("对比功能暂未实现 (预留)！")})};const initHamburgerMenu=()=>{const e=document.getElementById("menuIcon"),t=document.getElementById("mobileNav"),n=document.getElementById("closeBtn");if(!e||!t||!n)return;e.addEventListener("click",()=>{t.classList.add("active")}),n.addEventListener("click",()=>{t.classList.remove("active")}),t.querySelectorAll("ul li a").forEach(r=>{r.addEventListener("click",()=>{t.classList.remove("active")})})};const initModalWindows=()=>{document.querySelectorAll("[data-modal-target]").forEach(e=>{e.addEventListener("click",()=>{const t=document.querySelector(e.getAttribute("data-modal-target"));t&&t.classList.add("active")})});document.querySelectorAll("[data-modal-close]").forEach(e=>{e.addEventListener("click",()=>{const t=e.closest(".modal");t&&t.classList.remove("active")})})};const initInfiniteScroller=()=>{const e=document.getElementById("infiniteScroller"),t=document.querySelector(".pause-btn");if(!e||!t)return;const n=["A peaceful brookside setting.png","A scenic riverside bend.png","A serene coastal shore.png","A shaded forest path.png"];let r=false,s=0.3,o=0,i=[],u;u=document.createElement("div"),u.className="infinite-scroller-track",u.style.display="flex",u.style.position="relative",u.style.transform="translateX(0)",e.appendChild(u);for(let a=0;a<2;a++)n.forEach(c=>{createItem(c)});function createItem(c){const d=document.createElement("div");d.className="infinite-scroller-item",d.style.position="absolute",d.style.width="100%";const f=document.createElement("img");f.src=c,f.alt=c,f.style.width="100%",f.style.objectFit="cover",d.appendChild(f),u.appendChild(d);const g=i.length===0?0:(i[i.length-1].x+d.offsetWidth);d.style.left=`${g}px`,i.push({el:d,x:g,width:d.offsetWidth})}function a(t){if(!r){const c=t-o;c&&(o=t);const d=s*(c/16.67);for(let f=0;f<i.length;f++){let g=i[f];g.x-=d,g.el.style.left=`${g.x}px`}const h=i[i.length-1];h.x+h.width<window.innerWidth+100&&createItem(n[i.length%n.length])}requestAnimationFrame(a)}t.classList.remove("paused"),t.addEventListener("click",()=>{r=!r,t.classList.toggle("paused")}),requestAnimationFrame(a),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("infiniteScroller"),c=document.querySelector(".infinite-scroller-track");t&&c&&(c.style.transform="translateX(0)",t.innerHTML+=t.innerHTML);const d=document.getElementById("pauseBtn");let f=false;d.addEventListener("click",function(){f=!f,t.style.animationPlayState=f?"paused":"running",d.textContent=f?"▶":"❚❚"}),d.textContent="❚❚"}),document.addEventListener("DOMContentLoaded",function(){const t=document.querySelector(".infinite-scroller-track");t&&(t.style.transform="translateX(0)")})};const initProductImageClick=()=>{document.querySelectorAll(".product-card img").forEach(e=>{e.addEventListener("click",()=>{const t=e.alt.toLowerCase().replace(/\s+/g,"-")+".html";window.location.href=t})})};const initFlipCards=()=>{document.querySelectorAll(".flip-btn-front").forEach(e=>{e.addEventListener("click",()=>{e.closest(".card").style.transform="rotateY(180deg)"})});document.querySelectorAll(".flip-btn-back").forEach(e=>{e.addEventListener("click",()=>{e.closest(".card").style.transform="rotateY(0deg)"})})};const initFrameAnimation=()=>{const e=document.getElementById("animationCanvas"),t=e?.getContext("2d");if(!e||!t)return;const n=["A young man standing in a natural landscape1.png","A young man standing in a natural landscape2.png","A young man standing in a natural landscape3.png"];let r=[],i=0,s=true,o=0,u=0.02,a=1000/24,c=0,d=0;const f=document.getElementById("playPauseButton");n.forEach((e,i)=>{let n=new Image();n.src=e,n.onload=()=>{r[i]=n,d++,console.log(`✅ 加载成功: ${e}`),d===1&&requestAnimationFrame(l)},n.onerror=()=>console.error(`❌ 图片加载失败: ${e}`)});function l(e){if(!s||d===0)return;if(e-c>a){t.clearRect(0,0,e.width,e.height);let n=(i+1)%n.length;r[i]&&(t.globalAlpha=1-o, m(r[i])),r[(i+1)%n.length]&&(t.globalAlpha=o, m(r[(i+1)%n.length])),o+=u,o>=1&&(o=0,i=(i+1)%n.length),c=e}requestAnimationFrame(l)}function m(e){const n=e.width/e.height,i=e.width/e.height,r=e.width/e.height,s=e.width/e.height,o=(e.width-e.width)/2,u=(e.height-e.height)/2;t.drawImage(e,o,u,e.width,e.height)}f?.addEventListener("click",()=>{s=!s,f.textContent=s?"❚❚":"▶",s&&requestAnimationFrame(l)})};const initTouch1CarouselTrack=()=>{const e=document.querySelector(".touch1-carousel-track"),t=Array.from(e?.children||[]),n=document.querySelector(".touch1-prev-btn"),r=document.querySelector(".touch1-next-btn");if(!e||t.length===0||!n||!r)return;let i=0,o=615+15;function u(){e.style.transform=`translateX(-${i*o}px)`,n.disabled=(i===0),r.disabled=(i===t.length-1)};n.addEventListener("click",()=>{i>0&&(i--,u())}),r.addEventListener("click",()=>{i<t.length-1&&(i++,u())}),u()};document.addEventListener("DOMContentLoaded",()=>{initHeroCarousel();initEmailJS();initCompareFeature();initHamburgerMenu();initModalWindows();initInfiniteScroller();initProductImageClick();initFlipCards();initFrameAnimation();initTouch1CarouselTrack()});document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".touch1-carousel-track"),t=Array.from(e.children),n=document.querySelector(".touch1-prev-btn"),r=document.querySelector(".touch1-next-btn");let i=0,o=t.length,u=615+15;function s(){e.style.transform=`translateX(-${i*u}px)`,n.disabled=(i===0),r.disabled=(i===o-1)};n.addEventListener("click",()=>{i>0&&(i--,s())}),r.addEventListener("click",()=>{i<o-1&&(i++,s())}),s()});
