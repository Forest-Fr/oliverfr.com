"use strict";function waitImagesLoaded(e,t){let n=0;const o=e.length;function r(){++n>=o&&t()}e.forEach(a=>{a.complete?r():(a.addEventListener("load",r),a.addEventListener("error",r))}),0===o&&t()}const initHeroCarousel=()=>{const e=document.getElementById("hero-slides"),t=document.querySelectorAll(".hero-dots .dot");if(!e||0===t.length)return;let n=0;const o=e.children.length;function r(){n=(n+1)%o,e.style.transform=`translateX(-${100*n}%)`,t.forEach((e,t)=>{e.classList.toggle("active",t===n)})}t.forEach((o,r)=>{o.addEventListener("click",()=>{n=r,e.style.transform=`translateX(-${100*n}%)`,t.forEach((e,t)=>{e.classList.toggle("active",t===n)})})}),setInterval(r,5e3)},initEmailJS=()=>{if("undefined"==typeof emailjs)return;emailjs.init("HXCThZROMytOt-wyp");const e=document.getElementById("contactForm");e&&e.addEventListener("submit",t=>{t.preventDefault(),emailjs.sendForm("service_1ffkva1","template_ypdj9n9",e).then(()=>{alert("邮件已发送成功，我们将尽快与您联系！"),e.reset()}).catch(e=>{console.error("邮件发送失败：",e),alert("邮件发送失败，请稍后再试。")})})},initCompareFeature=()=>{const e=document.querySelector(".compare-features .btn");e&&e.addEventListener("click",()=>{alert("对比功能暂未实现 (预留)！")})},initHamburgerMenu=()=>{const e=document.getElementById("menuIcon"),t=document.getElementById("mobileNav"),n=document.getElementById("closeBtn");if(!e||!t||!n)return;e.addEventListener("click",()=>{t.classList.add("active")}),n.addEventListener("click",()=>{t.classList.remove("active")});t.querySelectorAll("ul li a").forEach(e=>{e.addEventListener("click",()=>{t.classList.remove("active")})})},initModalWindows=()=>{document.querySelectorAll("[data-modal-target]").forEach(e=>{e.addEventListener("click",()=>{const t=document.querySelector(e.getAttribute("data-modal-target"));t&&t.classList.add("active")})}),document.querySelectorAll("[data-modal-close]").forEach(e=>{e.addEventListener("click",()=>{const t=e.closest(".modal");t&&t.classList.remove("active")})})},initInfiniteScroller=()=>{const e=document.getElementById("infiniteScroller"),t=document.querySelector(".pause-btn");if(!e||!t)return;const n=["A peaceful brookside setting.png","A scenic riverside bend.png","A serene coastal shore.png","A shaded forest path.png"];let o=!1,r=.3,i=0,a=[],c=document.createElement("div");function s(l){if(!o){const e=l-i;i=l;const t=r*(e/16.67);for(let e=0;e<a.length;e++){const n=a[e];n.x-=t,n.el.style.left=`${n.x}px`}const o=a[a.length-1];o.x+o.width<window.innerWidth+100&&m(n[a.length%n.length])}requestAnimationFrame(s)}function m(e){const t=document.createElement("div");t.className="infinite-scroller-item",t.style.position="absolute",t.style.width="100%";const n=document.createElement("img");n.src=e,n.alt=e,n.style.width="100%",n.style.objectFit="cover",t.appendChild(n),c.appendChild(t);const o=0===a.length?0:a[a.length-1].x+t.offsetWidth;t.style.left=`${o}px`;const r={el:t,x:o,width:t.offsetWidth};a.push(r)}c.className="infinite-scroller-track",c.style.display="flex",c.style.position="relative",c.style.transform="translateX(0)",e.appendChild(c);for(let e=0;e<2;e++)n.forEach(m);t.classList.remove("paused"),t.addEventListener("click",()=>{o=!o,t.classList.toggle("paused")}),requestAnimationFrame(s)},initProductImageClick=()=>{document.querySelectorAll(".product-card img").forEach(e=>{e.addEventListener("click",()=>{const t=e.alt.toLowerCase().replace(/\s+/g,"-")+".html";window.location.href=t})})},initFlipCards=()=>{document.querySelectorAll(".flip-btn-front").forEach(e=>{e.addEventListener("click",()=>{e.closest(".card").style.transform="rotateY(180deg)"})}),document.querySelectorAll(".flip-btn-back").forEach(e=>{e.addEventListener("click",()=>{e.closest(".card").style.transform="rotateY(0deg)"})})},initFrameAnimation=()=>{const e=document.getElementById("animationCanvas"),t=e?.getContext("2d");if(!e||!t)return;const n=["A young man standing in a natural landscape1.png","A young man standing in a natural landscape2.png","A young man standing in a natural landscape3.png"];let o=[],r=0,i=!0,a=0,c=.02,s=1e3/24,l=0,d=0;const m=document.getElementById("playPauseButton");n.forEach((e,t)=>{const n=new Image;n.src=e,n.onload=()=>{o[t]=n,d++,1===d&&requestAnimationFrame(f)},n.onerror=()=>console.error("❌ 图片加载失败: "+e)}),window.addEventListener("resize",h),h();function h(){if(!e)return;window.innerWidth>=1024?(e.width=window.innerWidth,e.height=.75*window.innerHeight):(e.width=window.innerWidth,e.height=.6*window.innerHeight)}function f(p){if(!i||0===d)return;if(!e||!t)return;p-l>s&&(t.clearRect(0,0,e.width,e.height),(()=>{let e=(r+1)%o.length;o[r]&&(t.globalAlpha=1-a,g(o[r])),o[e]&&(t.globalAlpha=a,g(o[e])),a+=c,a>=1&&(a=0,r=e)})(),l=p),requestAnimationFrame(f)}function g(n){const o=e.width/e.height,r=n.width/n.height;let i,a,c,s;if(r>o?(a=.9*e.height,i=n.width*(a/n.height),s=(e.width-i)/2,c=(e.height-a)/2):(i=e.width,a=n.height*(i/n.width),s=0,c=(e.height-a)/2),t.drawImage(n,s,c,i,a)}m?.addEventListener("click",()=>{i=!i,m.textContent=i?"❚❚":"▶",i&&requestAnimationFrame(f)})},initTouch1CarouselTrack=()=>{const e=document.querySelector(".touch1-carousel-track"),t=Array.from(e?.children||[]),n=document.querySelector(".touch1-prev-btn"),o=document.querySelector(".touch1-next-btn");if(!e||0===t.length||!n||!o)return;let r=0;const i=630;function a(){e.style.transform=`translateX(-${r*i}px)`,n.disabled=0===r,o.disabled=r===t.length-1}n.addEventListener("click",()=>{r>0&&(r--,a())}),o.addEventListener("click",()=>{r<t.length-1&&(r++,a())}),a()},initspec1ManualCarouselTrack=()=>{const e=document.querySelector(".spec1-carousel-container"),t=document.querySelector(".spec1-carousel-track");let n=Array.from(document.querySelectorAll(".spec1-carousel-slide"));const o=document.querySelector(".spec1-carousel-prev"),r=document.querySelector(".spec1-carousel-next");if(!e||!t||0===n.length||!o||!r){console.warn("spec1 hand-control carousel: elements or arrows not found!");return}const i=n.length;let a=1,c=!1,s=0,l=15;const d=n[0].cloneNode(!0),m=n[i-1].cloneNode(!0);t.appendChild(d),t.insertBefore(m,t.firstChild),n=Array.from(t.querySelectorAll(".spec1-carousel-slide"));function h(){if(window.innerWidth<=768){const t=e.offsetWidth;l=.04*t,n.forEach(e=>{e.style.width=`${.85*t}px`}),s=.85*t+l}else{n.forEach(e=>{e.style.width=""}),l=15;const e=n[1].getBoundingClientRect().width;s=e+l}}function f(e=!0){h(),t.style.transition=e?"transform 0.5s ease-in-out":"none",window.innerWidth<=768?t.style.transform=`translateX(${-a*s+l/2}px)`:t.style.transform=`translateX(${-a*s}px)`,n.forEach(e=>e.classList.remove("active","prev","next","shadow")),n[a]?.classList.add("active");const o=(a+1)%n.length,r=(a-1+n.length)%n.length;n[o]?.classList.add("next"),n[r]?.classList.add("prev"),n.forEach(e=>{e.classList.contains("active")||e.classList.add("shadow")}),n.forEach(e=>{const t=e.querySelector("a");t&&(t.style.pointerEvents=e.classList.contains("active")?"auto":"none")})}function g(){if(c)return;c=!0,a++,f(!0),setTimeout(()=>{a===n.length-1&&(t.style.transition="none",a=1,f(!1)),c=!1},500)}function p(){if(c)return;c=!0,a--,f(!0),setTimeout(()=>{0===a&&(t.style.transition="none",a=n.length-2,f(!1)),c=!1},500)}o.addEventListener("click",()=>{c||p()}),r.addEventListener("click",()=>{c||g()}),n.forEach(e=>{e.addEventListener("click",t=>{e.classList.contains("active")||e.classList.contains("next")?(t.preventDefault(),c||g()):e.classList.contains("prev")&&(t.preventDefault(),c||p())});const t=e.querySelector(".spec1-explore-btn");t&&t.addEventListener("click",e=>{e.stopPropagation()})});let v=0,u=!1;t.addEventListener("touchstart",function(e){1===e.touches.length&&!c&&(v=e.touches[0].clientX,u=!0)},{passive:!0}),t.addEventListener("touchmove",()=>{},{passive:!0}),t.addEventListener("touchend",function(e){if(!u)return;u=!1;const t=e.changedTouches[0].clientX,n=t-v;Math.abs(n)>20&&(n<0?g():p())},{passive:!0});function w(){c=!1,t.style.transition="none",f(!1),setTimeout(()=>{t.style.transition="transform 0.5s ease-in-out"},50)}window.addEventListener("resize",w),t.style.transition="none",f(!1),setTimeout(()=>{t.style.transition="transform 0.5s ease-in-out"},50),window.innerWidth<=768?(o.style.display="block",r.style.display="block"):(o.style.display="block",r.style.display="block")};document.addEventListener("DOMContentLoaded",()=>{initHeroCarousel(),initEmailJS(),initCompareFeature(),initHamburgerMenu(),initModalWindows(),initInfiniteScroller(),initProductImageClick(),initFlipCards(),initFrameAnimation(),initTouch1CarouselTrack()}),window.addEventListener("load",()=>{const e=document.querySelectorAll(".spec1-carousel-slide img");e.length>0&&waitImagesLoaded(e,()=>{initspec1ManualCarouselTrack()})});
